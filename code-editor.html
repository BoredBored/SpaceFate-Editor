<!DOCTYPE html>
<html lang="en-US">
    
    <head>
        <meta charset="utf-8">
        <title>Spacefate Editor</title>
        <script src='http://codemirror.net/lib/codemirror.js'></script>
        <script src='http://codemirror.net/mode/xml/xml.js'></script>
        <script src='http://codemirror.net/mode/javascript/javascript.js'></script>
        <script src='http://codemirror.net/mode/css/css.js'></script>
        <script src='http://codemirror.net/mode/htmlmixed/htmlmixed.js'></script>
        <link rel='stylesheet' href='http://codemirror.net/lib/codemirror.css'>
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <style type='text/css'>
            .CodeMirror {
            	height: auto;
		width: auto;
            }
            iframe {
                border: 1px solid black;
		height: auto;
		width: auto;
            }
          .hide {
            display: none;  
	}
	input[type="file"] { display: none; }
        </style>
    </head>
    
    <body>
	<!-- Top nav -->
	<div class="w3-container">
		<div class="w3-bar w3-border w3-card-4 w3-light-grey w3-margin-bottom">
			<button class="w3-bar-item w3-button" id="SideBar">&#9776;</button>
			<a href="#" class="w3-bar-item w3-button">Home</a>
			<a href="#" class="w3-bar-item w3-button w3-right">Link</a>
		</div>
	</div>
	<!-- Sidebar -->
	<div class="w3-container">
		<div class="w3-sidebar w3-bar-block w3-card-2 w3-animate-left" style="display:none" id="Sidebar">
  			<button class="w3-bar-item w3-button w3-large w3-right-align" onclick="w3_close()" style="font-weight: bold;">&times;</button>
			<a href="#" class="w3-bar-item w3-button w3-hover-none w3-padding-16 w3-large"><u>Mode</u></a>
				<a href="#" class="w3-bar-item w3-button w3-right-align">Visual Editor</a>
				<a href="#" class="w3-bar-item w3-button w3-right-align">Terminal</a>
                                <a href="#" class="w3-bar-item w3-button w3-right-align">Server Info Page</a>
		</div>
	</div>
	<!-- Code editor -->
	<div id="main">
		<div class="w3-container">
			<div class="w3-bar w3-margin-bottom">
				<label class="w3-bar-item w3-button">
					<input type="file" onchange="loadfile(this)">
					Upload
				</label>
				<button class="w3-bar-item w3-button w3-green">Download</button>
			</div>
				<div class="w3-container">
					<textarea id="code" name="code"><!DOCTYPE html>
<html lang="en-US">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<script src="https://www.w3schools.com/lib/w3.js"></script>
		<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
	</head>
	<body>
		
	</body>
<html></textarea>
				</div>
				<div class="w3-container hide">
					<iframe id="preview"></iframe>
				</div>
				<div class="w3-container">

        <script>
            var delay;

            // Initialize CodeMirror editor
            var editor = CodeMirror.fromTextArea(document.getElementById('code'), {
                mode: 'text/html',
                tabMode: 'indent',
                lineNumbers: true,
                lineWrapping: true,
                autoCloseTags: true
            });

            // Live preview
            editor.on("change", function() {
                clearTimeout(delay);
                delay = setTimeout(updatePreview, 300);
            });

            function updatePreview() {
                localStorage.code = editor.getValue();
            }
            setTimeout(updatePreview, 300);

            function saveTextAsFile() {
                var textToWrite = document.getElementById("code").value;
                var textFileAsBlob = new Blob([textToWrite], {
                    type: 'text/html'
                });
                var fileNameToSaveAs = "";
                var downloadLink = document.createElement("a");
                downloadLink.innerHTML = "Download File";
                if (window.webkitURL != null) {
                    // Chrome allows the link to be clicked
                    // without actually adding it to the DOM.
                    downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
                } else {
                    // Firefox requires the link to be added to the DOM
                    // before it can be clicked.
                    downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
                    downloadLink.onclick = destroyClickedElement;
                    downloadLink.style.display = "none";
                    document.body.appendChild(downloadLink);
                }

                downloadLink.click();
            }

            function destroyClickedElement(event) {
                document.body.removeChild(event.target);
            }

            function loadfile(input) {
                var reader = new FileReader();
                reader.onload = function(e) {
                    editor.setValue(e.target.result);
                }
                reader.readAsText(input.files[0]);
            }

            var input = document.getElementById("select");

            function selectTheme() {
                var theme = input.options[input.selectedIndex].innerHTML;
                editor.setOption("theme", theme);
            }

            var choice = document.location.search && decodeURIComponent(document.location.search.slice(1));
            if (choice) {
                input.value = choice;
                editor.setOption("theme", choice);
            }
	document.getElementById("SideBar").onclick = function() {w3_open()};

	function w3_open() {
		document.getElementById("main").style.marginLeft = "16%";
  		document.getElementById("Sidebar").style.width = "15%";
  		document.getElementById("Sidebar").style.display = "block";
	}
	function w3_close() {
  		document.getElementById("main").style.marginLeft = "0%";
  		document.getElementById("Sidebar").style.display = "none";
 
	}
	function PreToggle() {
		var x = document.getElementById('preview');
		if (x.style.display === 'none') {
			x.style.display = 'block';
		} else {
			x.style.display = 'none';
		}
	}
        </script>
    </body>
</html>
